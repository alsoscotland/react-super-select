!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.reactSuperSelect=e()}}(function(){return function e(t,s,i){function a(o,n){if(!s[o]){if(!t[o]){var l="function"==typeof require&&require;if(!n&&l)return l(o,!0);if(r)return r(o,!0);var p=new Error("Cannot find module '"+o+"'");throw p.code="MODULE_NOT_FOUND",p}var c=s[o]={exports:{}};t[o][0].call(c.exports,function(e){var s=t[o][1][e];return a(s?s:e)},c,c.exports,e,t,s,i)}return s[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,t,s){(function(s){"use strict";var i=e("lodash"),a=e("classnames"),r="undefined"!=typeof window?window.React:"undefined"!=typeof s?s.React:null,o=r.createClass({displayName:"ReactSuperSelect",propTypes:{multiple:r.PropTypes.bool,searchable:r.PropTypes.bool,tags:r.PropTypes.bool,triggerEnabled:r.PropTypes.bool,customClass:r.PropTypes.string,customGroupHeadingClass:r.PropTypes.string,customSearchIconClass:r.PropTypes.string,customLoaderClass:r.PropTypes.string,customTagClass:r.PropTypes.string,onChange:r.PropTypes.func.isRequired,ajaxDataFetch:r.PropTypes.func,dataSource:r.PropTypes.oneOfType([r.PropTypes.arrayOf(r.PropTypes.object),r.PropTypes.object]),initialValue:r.PropTypes.oneOfType([r.PropTypes.arrayOf(r.PropTypes.object),r.PropTypes.object]),optionLabelKey:r.PropTypes.string,optionValueKey:r.PropTypes.string,pageDataFetch:r.PropTypes.func,hasMorePages:r.PropTypes.func,groupBy:r.PropTypes.oneOfType([r.PropTypes.string,r.PropTypes.func,r.PropTypes.object]),customGroupHeadingTemplateFunction:r.PropTypes.func,customFilterFunction:r.PropTypes.func,customOptionTemplateFunction:r.PropTypes.func,ajaxErrorString:r.PropTypes.string,noResultsString:r.PropTypes.string,placeholder:r.PropTypes.string,searchPlaceholder:r.PropTypes.string,tagRemoveLabelString:r.PropTypes.string},SEARCH_FOCUS_ID:-1,SELECTED_OPTION_REGEX:/r-ss-selected/,DEFAULT_LOCALIZATIONS:{ajaxErrorString:"An Error occured while fetching options",noResultsString:"No Results Available",placeholder:"Select an Option",searchPlaceholder:"Search",tagRemoveLabelString:"Remove Tag"},getInitialState:function(){return{ajaxError:!1,controlId:i.uniqueId("rss_"),data:this._configureDataSource(this.props.dataSource),rawDataSource:this.props.dataSource,isOpen:i.isUndefined(this.props.triggerEnabled)?!1:!this.props.triggerEnabled,focusedId:void 0,labelKey:this.props.optionLabelKey||"name",lastOptionId:i.isArray(this.props.dataSource)&&this.props.dataSource.length>0?this.props.dataSource.length-1:void 0,searchString:void 0,value:this._buildInitialValue(),valueKey:this.props.optionValueKey||"id"}},keymap:{down:40,end:35,enter:13,esc:27,home:36,space:32,tab:9,up:38},lastUserSelectedOption:void 0,componentWillReceiveProps:function(e){var t={};i.isEqual(e.initialValue,this.props.initialValue)||(t.value=this._buildInitialValue(e)),i.isUndefined(e.optionLabelKey)||e.optionLabelKey===this.props.optionLabelKey||(t.labelKey=e.optionLabelKey),i.isUndefined(e.optionValueKey)||e.optionValueKey===this.props.optionValueKey||(t.valueKey=e.optionValueKey),i.isEqual(this.props.dataSource,e.dataSource)||(this.lastUserSelectedOption=void 0,t=i.extend(t,{data:this._configureDataSource(e.dataSource),rawDataSource:e.dataSource,focusedId:void 0,lastOptionId:i.isArray(e.dataSource)&&e.dataSource.length>0?e.dataSource.length-1:void 0})),i.isEmpty(t)||this.setState(t)},componentDidUpdate:function(){this._focusCurrentFocusedId()},render:function(){var e=this._getDropdownContent(),t=this._getTriggerDiv(),s=a("r-ss-wrap",this.props.customClass,{"r-ss-expanded":this.state.isOpen});return r.createElement("div",{ref:"rssControl",id:this.state.controlId,className:s},t,e)},toggleDropdown:function(){this.setState({isOpen:!this.state.isOpen},function(){this.state.isOpen&&this._setFocusOnOpen()})},_ariaGetActiveDescendentId:function(){var e=null,t=this._getFocusedOptionKey();return this.refs[t]&&(e=this.refs[t].props.id),e},_ariaGetListId:function(){return this.state.controlId+"_list"},_buildInitialValue:function(e){e=e||this.props;var t=[];return i.isUndefined(e.initialValue)||(t=i.isArray(e.initialValue)?e.initialValue:[e.initialValue],this._isMultiSelect()||(t=[i.first(t)])),t},_closeOnKeypress:function(){this.state.isOpen&&this.setState({isOpen:!1,focusedId:void 0},this._focusTrigger)},_configureDataSource:function(e){if(i.isArray(e))return e;if(i.isObject(e)){if(i.isArray(e.collection))return e.collection;if(i.isFunction(e.get)){var t=e.get("collection");if(i.isArray(t))return t}}return[]},_defaultSearchFilter:function(e){var t=this.state.searchString.toLowerCase();return i.isString(e[this.state.labelKey])?e[this.state.labelKey].toLowerCase().indexOf(t)>-1:!1},_fetchDataViaAjax:function(){var e=this;this.props.ajaxDataFetch(this.state.rawDataSource).then(function(t){e.setState({ajaxError:!1,data:e._configureDataSource(t),rawDataSource:t})},function(){e.setState({ajaxError:!0,rawDataSource:[]})})},_fetchNextPage:function(){var e=this;this.props.pageDataFetch(this.state.rawDataSource).then(function(t){e.setState({ajaxError:!1,data:e._configureDataSource(t),rawDataSource:t,isFetchingPage:!1})},function(){e.setState({ajaxError:!0})})},_filterDataBySearchString:function(e){var t=this,s=this._defaultSearchFilter;return i.isFunction(this.props.customFilterFunction)&&(s=function(e,s,i){return t.props.customFilterFunction.apply(t,[e,s,i,t.state.searchString.toLowerCase()])}),i.filter(e,s)},_findArrayOfOptionDataObjectsByValue:function(e){var t=i.isArray(e)?i.pluck(e,this.state.valueKey):[e];return i.reject(this.state.data,function(e){return!i.contains(t,e[this.state.valueKey])},this)},_focusCurrentFocusedId:function(){return this.state.focusedId<0?void this._focusSearch():void this._focusDOMOption()},_focusDOMOption:function(){var e=this._getFocusedOptionKey();this.refs[e]&&i.isFunction(this.refs[e].getDOMNode().focus)&&this.refs[e].getDOMNode().focus()},_focusSearch:function(){this.refs.searchInput&&this.refs.searchInput.getDOMNode().focus()},_focusTrigger:function(){this.refs.triggerDiv&&this.refs.triggerDiv.getDOMNode().focus()},_generateValueDisplay:function(){return this.props.tags?this._getTagsDisplayMarkup():this._getNormalDisplayMarkup()},_getAjaxErrorMarkup:function(){var e=this.props.ajaxErrorString?this.props.ajaxErrorString:this.DEFAULT_LOCALIZATIONS.ajaxErrorString;return r.createElement("li",{className:"r-ss-dropdown-option error"},r.createElement("i",{ref:"errorDisplay"},e))},_getDataSource:function(){var e=i.isArray(this.state.data)?this.state.data:[];return i.isString(this.state.searchString)&&(e=this._filterDataBySearchString(e)),this.props.groupBy&&(e=i.groupBy(e,this.props.groupBy)),e},_getTriggerDiv:function(){var e=i.isUndefined(this.props.triggerEnabled)?!0:this.props.triggerEnabled;if(e){var t=this.props.placeholder?this.props.placeholder:this.DEFAULT_LOCALIZATIONS.placeholder,s=a("r-ss-trigger",{"r-ss-open":this.state.isOpen,"r-ss-placeholder":this.state.value.length<1}),o=a("carat",{down:!this.state.isOpen,up:this.state.isOpen}),n=this.state.value.length?this._generateValueDisplay():t;return r.createElement("div",{ref:"triggerDiv",className:s,onClick:this.toggleDropdown,onKeyDown:this._handleKeyDown,role:"combobox","aria-activedescendant":this._ariaGetActiveDescendentId(),"aria-haspopup":!0,"aria-controls":this._ariaGetListId(),"aria-label":t,"aria-multiselectable":this._isMultiSelect(),tabIndex:"1"},n,r.createElement("span",{ref:"carat",className:o}," "))}return null},_getDropdownContent:function(){if(!this.state.isOpen)return null;var e,t,s=this._getSearchContent();return e=this.props.pageDataFetch?this._onMouseMove:null,t=this.state.isFetchingPage?this._getPagingLi():null,r.createElement("div",{ref:"dropdownContent",className:"r-ss-dropdown",onKeyDown:this._handleKeyDown},s,r.createElement("div",{ref:"scrollWrap",className:"r-ss-options-wrap",onMouseMove:e},r.createElement("ul",{className:"r-ss-dropdown-options",ref:"dropdownOptionsList",tabIndex:"-1",id:this._ariaGetListId(),role:"listbox","aria-expanded":this.state.isOpen},this._getOptionsMarkup()),t))},_getFocusedOptionKey:function(){return"option_"+this.state.focusedId},_getGroupHeadingMarkup:function(e){if(!e)return null;var t=a("r-ss-option-group-heading",this.props.customGroupHeadingClass),s="heading_"+e,i=this.props.customGroupHeadingTemplateFunction?this.props.customGroupHeadingTemplateFunction(e):e;return r.createElement("li",{tabIndex:"-1",className:t,key:s,role:"separator","aria-label":e,"aria-hidden":!0},i)},_getNoResultsMarkup:function(){var e=this.props.noResultsString?this.props.noResultsString:this.DEFAULT_LOCALIZATIONS.noResultsString;return r.createElement("li",{className:"r-ss-dropdown-option",tabIndex:"-1"},r.createElement("i",{ref:"noResults"},e))},_getNormalDisplayMarkup:function(){return i.map(this.state.value,function(e){var t="r_ss_selected_"+e[this.state.labelKey];return this.props.customOptionTemplateFunction?this.props.customOptionTemplateFunction(e):r.createElement("span",{key:t,className:"r-ss-selected-label"},e[this.state.labelKey])},this)},_getLoadingMarkup:function(){var e=this.props.customLoaderClass?"r-ss-loader "+this.props.customLoaderClass:"r-ss-loader";return r.createElement("span",{ref:"loader",className:e})},_getOptionIndexFromTarget:function(e){return parseInt(e.getAttribute("data-option-index"),10)},_getOptionsMarkup:function(){if(this._needsAjaxFetch())return this._fetchDataViaAjax(),this._getPagingLi();if(this.state.ajaxError)return this._getAjaxErrorMarkup();var e=this._getDataSource(),t=[],s=0;return i.isArray(e)?t=this._getTemplatedOptions(e):i.forIn(e,function(e,i){t.push(this._getGroupHeadingMarkup(i)),t=t.concat(this._getTemplatedOptions(e,s)),s+=e.length},this),t},_getPagingLi:function(){return r.createElement("li",{key:"page_loading",className:"r-ss-page-fetch-indicator",tabIndex:"-1"},this._getLoadingMarkup())},_getSearchContent:function(){if(!this.props.searchable)return null;var e=this.props.customSearchIconClass?this.props.customSearchIconClass:"r-ss-magnifier",t=this.props.searchPlaceholder?this.props.searchPlaceholder:this.DEFAULT_LOCALIZATIONS.searchPlaceholder,s=this.state.controlId+"_search",i=s+"_label";return r.createElement("div",{className:"r-ss-search-wrap"},r.createElement("div",{className:"r-ss-search-inner"},r.createElement("label",{ref:"searchInputLabel",id:i,className:"r-ss-search-aria-label",htmlFor:s},t),r.createElement("input",{ref:"searchInput",placeholder:t,onClick:this._setFocusIdToSearch,onChange:this._handleSearch,defaultValue:this.state.searchString,name:s,id:s,"aria-labelledby":i,"aria-autocomplete":"list"}),r.createElement("i",{className:e},"search")))},_getTagsDisplayMarkup:function(){return i.map(this.state.value,function(e){return this._getTagMarkup(e)},this)},_getTagMarkup:function(e){var t=e[this.state.labelKey],s=e[this.state.valueKey],i="tag_"+s,a="RemoveTag_"+s,o=this._getTagRemoveIndex(s),n=this.props.tagRemoveLabelString?this.props.tagRemoveLabelString:this.DEFAULT_LOCALIZATIONS.tagRemoveLabelString,l=this.props.customTagClass?"r-ss-tag "+this.props.customTagClass:"r-ss-tag";return n=n+" "+t,r.createElement("span",{className:l,key:i},r.createElement("span",{className:"r-ss-tag-label"},t),r.createElement("button",{"aria-label":n,ref:o,name:a,type:"button",className:"r-ss-tag-remove",onClick:this._removeTagClick.bind(null,e),onKeyDown:this._removeTagKeyPress.bind(null,e)},r.createElement("span",null)))},_getTagRemoveIndex:function(e){return"tag_remove_"+e},_getTemplatedOptions:function(e,t){t=t||0;var s=this._mapDataToOptionsMarkup(e,t);return 0===s.length&&(s=this._getNoResultsMarkup()),s},_handleKeyDown:function(e){if(!this._isUserSearchTypingEvent(e))switch((this.state.isOpen||e.which!==this.keymap.tab)&&(e.stopPropagation(),e.preventDefault()),e.which){case this.keymap.down:this._onDownKey(e);break;case this.keymap.end:this._onEndKey();break;case this.keymap.enter:this._onEnterKey(e);break;case this.keymap.esc:this._onEscKey();break;case this.keymap.home:this._onHomeKey();break;case this.keymap.space:this._onEnterKey(e);break;case this.keymap.tab:this.state.isOpen&&this._onEnterKey(e);break;case this.keymap.up:this._onUpKey(e)}},_handleSearch:function(e){e.stopPropagation(),e.preventDefault();var t=e.target.value;this._handleSearchDebounced.call(this,t)},_handleSearchDebounced:i.debounce(function(e){this.setState({searchString:e})},300),_isCurrentlySelected:function(e){return i.isArray(this.state.value)?!!i.findWhere(this.state.value,e):i.isEqual(this.state.value,e)},_isMultiSelect:function(){return this.props.multiple||this.props.tags},_isUserSearchTypingEvent:function(e){return!this.refs.searchInput||e.which===this.keymap.down||e.which===this.keymap.up&&e.altKey||e.which===this.keymap.esc?!1:e.target===this.refs.searchInput.getDOMNode()},_mapDataToOptionsMarkup:function(e,t){return i.map(e,function(e,s){s=t+s;var o=this._isCurrentlySelected(e),n="drop_li_"+e[this.state.valueKey],l="option_"+s,p=this.state.controlId+"_aria_"+l,c=i.isFunction(this.props.customOptionTemplateFunction)?this.props.customOptionTemplateFunction(e):e[this.state.labelKey],u=a("r-ss-dropdown-option",{"r-ss-selected":o});return r.createElement("li",{ref:l,id:p,tabIndex:"0","data-option-index":s,className:u,"aria-selected":o,key:n,"data-option-value":e[this.state.valueKey],onClick:this._selectItemOnOptionClick.bind(null,e),role:"option"},c)},this)},_moveFocusDown:function(){if(!this._needsAjaxFetch()){var e;e=i.isUndefined(this.state.focusedId)?this.props.searchable?this.SEARCH_FOCUS_ID:0:this.state.lastOptionId===this.state.focusedId?this.state.lastOptionId:this.state.focusedId+1,this._updateFocusedId(e)}},_moveFocusUp:function(){var e;i.isUndefined(this.state.focusedId)||this.state.focusedId===this.SEARCH_FOCUS_ID||(0===this.state.focusedId?this.props.searchable&&(e=this.SEARCH_FOCUS_ID):e=this.state.focusedId-1),this._updateFocusedId(e)},_needsAjaxFetch:function(){return i.isUndefined(this.state.rawDataSource)&&i.isFunction(this.props.ajaxDataFetch)},_onDownKey:function(e){return this.state.isOpen?(this._moveFocusDown(),void(this._isMultiSelect()&&e.shiftKey&&this._selectFocusedOption(e.target,!0))):void this.toggleDropdown()},_onEndKey:function(){this.state.lastOptionId&&this._updateFocusedId(this.state.lastOptionId)},_onEnterKey:function(e){if(!this.state.isOpen)return void this.toggleDropdown();if(this._isMultiSelect()&&e.shiftKey)return void this._selectAllOptionsToLastUserSelectedOption(e.target);var t=this._isMultiSelect()&&(e.ctrlKey||e.metaKey),s=this.SELECTED_OPTION_REGEX.test(e.target.getAttribute("class"));if(t&&s){var a=i.first(this._findArrayOfOptionDataObjectsByValue(e.target.getAttribute("data-option-value")));this._removeSelectedOptionByValue(a)}else s||this._selectFocusedOption(e.target,t)},_onEscKey:function(){(i.isUndefined(this.props.triggerEnabled)||this.props.triggerEnabled)&&this._closeOnKeypress()},_onHomeKey:function(){this._updateFocusedId(0)},_onMouseMove:function(){if(!this.refs.loader&&!this.state.searchString&&this._pageFetchingComplete()){var e=this.refs.scrollWrap.getDOMNode();e.scrollTop+e.offsetHeight>=e.scrollHeight&&this.setState({isFetchingPage:!0},this._fetchNextPage)}},_onUpKey:function(e){return e.altKey?void this._closeOnKeypress():void(this.state.isOpen&&(this._moveFocusUp(),this._isMultiSelect()&&e.shiftKey&&this._selectFocusedOption(e.target,!0)))},_pageFetchingComplete:function(){return i.isFunction(this.props.hasMorePages)?this.props.hasMorePages(this.state.rawDataSource):!1},_removeAllOptionsInOptionIdRange:function(e,t){for(var s=[],a=t>=e?e:t,r=t>=e?t:e,o=a;r>=o;o++){var n="option_"+o,l=this.refs[n];this.SELECTED_OPTION_REGEX.test(l.props.className)&&this.lastUserSelectedOption.getAttribute("data-option-value")!==l.getDOMNode().getAttribute("data-option-value")&&s.push(l.props["data-option-value"])}var p=i.reject(this.state.value,function(e){return i.includes(s,e[this.state.valueKey])},this);this.props.onChange(p),this.setState({value:p})},_removeSelectedOptionByValue:function(e,t){this.lastUserSelectedOption&&this.lastUserSelectedOption.getAttribute("data-option-value")===e[this.state.valueKey]&&(this.lastUserSelectedOption=void 0);var s=i.reject(this.state.value,function(t){return t[this.state.valueKey]===e[this.state.valueKey]},this);this.props.onChange(s),t=i.isFunction(t)?t:i.noop,this.setState({value:s},t)},_removeTagKeyPress:function(e,t){var s=t.which===this.keymap.enter,i=t.which===this.keymap.space;(s||i)&&(t.preventDefault(),t.stopPropagation(),this._removeSelectedOptionByValue(e,this._setFocusToTagRemovalIfPresent))},_removeTagClick:function(e,t){t.preventDefault(),t.stopPropagation(),this._removeSelectedOptionByValue(e)},_selectAllOptionsInOptionIdRange:function(e,t){for(var s=[],a=t>=e?e:t,r=t>=e?t:e,o=a;r>=o;o++){var n="option_"+o,l=this.refs[n];this.SELECTED_OPTION_REGEX.test(l.props.className)||s.push(l.props["data-option-value"])}var p=i.reduce(this.state.data,function(e,t){return i.includes(s,t[this.state.valueKey])&&e.push(t),e},[],this);this._selectItemByValues(p,!0)},_selectAllOptionsToLastUserSelectedOption:function(e){if(!this.lastUserSelectedOption)return this.lastUserSelectedOption=e,void this._selectAllOptionsInOptionIdRange(0,this._getOptionIndexFromTarget(e));var t=this._getOptionIndexFromTarget(this.lastUserSelectedOption),s=this._getOptionIndexFromTarget(e);this.lastUserSelectedOption=e,this.SELECTED_OPTION_REGEX.test(e.getAttribute("class"))?this._removeAllOptionsInOptionIdRange(t,s):this._selectAllOptionsInOptionIdRange(t,s)},_selectFocusedOption:function(e,t){t=t||!1;var s=this._getFocusedOptionKey();if(this.refs[s]){var a=this.refs[s].props["data-option-value"];if(this.lastUserSelectedOption=e,t&&this.SELECTED_OPTION_REGEX.test(this.refs[s].props.className)){var r=i.first(this._findArrayOfOptionDataObjectsByValue(a));this._removeSelectedOptionByValue(r)}else this._selectItemByValues(a,t)}},_selectItemByValues:function(e,t){var s=this._findArrayOfOptionDataObjectsByValue(e);this._isMultiSelect()&&(s=this.state.value.concat(s));var a=this._isMultiSelect()?s:i.first(s);this.props.onChange(a);var r=t?null:this._closeOnKeypress;this.setState({value:a},r)},_selectItemOnOptionClick:function(e,t){if(this._isMultiSelect()&&t.shiftKey)return void this._selectAllOptionsToLastUserSelectedOption(t.currentTarget);var s=this._isMultiSelect()&&(t.ctrlKey||t.metaKey)||this.props.triggerEnabled===!1,i=this.SELECTED_OPTION_REGEX.test(t.currentTarget.getAttribute("class"));this.lastUserSelectedOption=t.currentTarget,s&&i?this._removeSelectedOptionByValue(e):i||this._selectItemByValues(e[this.state.valueKey],s)},_setFocusIdToSearch:function(){this._updateFocusedId(this.SEARCH_FOCUS_ID)},_setFocusOnOpen:function(){this.lastUserSelectedOption?this._updateFocusedId(parseInt(this.lastUserSelectedOption.getAttribute("data-option-index"),10)):this._moveFocusDown()},_setFocusToTagRemovalIfPresent:function(){if(!this.props.tags||0===this.state.value.length)return!1;var e=i.first(this.state.value)[this.state.valueKey],t=this.refs[this._getTagRemoveIndex(e)];return t&&i.isFunction(t.getDOMNode().focus)?(t.getDOMNode().focus(),!0):!1},_updateFocusedId:function(e){this.setState({focusedId:e})}});t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{classnames:void 0,lodash:void 0}]},{},[1])(1)});