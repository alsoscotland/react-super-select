!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.reactSuperSelect=e()}}(function(){return function e(t,s,i){function a(n,o){if(!s[n]){if(!t[n]){var l="function"==typeof require&&require;if(!o&&l)return l(n,!0);if(r)return r(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var p=s[n]={exports:{}};t[n][0].call(p.exports,function(e){var s=t[n][1][e];return a(s?s:e)},p,p.exports,e,t,s,i)}return s[n].exports}for(var r="function"==typeof require&&require,n=0;n<i.length;n++)a(i[n]);return a}({1:[function(e,t,s){(function(e){"use strict";var s="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i="undefined"!=typeof window?window.classNames:"undefined"!=typeof e?e.classNames:null,a="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,r=a.createClass({displayName:"ReactSuperSelect",propTypes:{clearable:a.PropTypes.bool,multiple:a.PropTypes.bool,searchable:a.PropTypes.bool,tags:a.PropTypes.bool,customClass:a.PropTypes.string,customGroupHeadingClass:a.PropTypes.string,customSearchIconClass:a.PropTypes.string,customLoaderClass:a.PropTypes.string,customTagClass:a.PropTypes.string,onChange:a.PropTypes.func.isRequired,ajaxDataFetch:a.PropTypes.func,dataSource:a.PropTypes.oneOfType([a.PropTypes.arrayOf(a.PropTypes.object),a.PropTypes.object]),initialValue:a.PropTypes.oneOfType([a.PropTypes.arrayOf(a.PropTypes.object),a.PropTypes.object]),optionLabelKey:a.PropTypes.string,optionValueKey:a.PropTypes.string,pageDataFetch:a.PropTypes.func,hasMorePages:a.PropTypes.func,groupBy:a.PropTypes.oneOfType([a.PropTypes.string,a.PropTypes.func,a.PropTypes.object]),customGroupHeadingTemplateFunction:a.PropTypes.func,customFilterFunction:a.PropTypes.func,customOptionTemplateFunction:a.PropTypes.func,ajaxErrorString:a.PropTypes.string,clearSelectionLabelString:a.PropTypes.string,clearSearchLabelString:a.PropTypes.string,noResultsString:a.PropTypes.string,placeholder:a.PropTypes.string,searchPlaceholder:a.PropTypes.string,tagRemoveLabelString:a.PropTypes.string},SEARCH_FOCUS_ID:-1,SELECTED_OPTION_REGEX:/r-ss-selected/,DEFAULT_LOCALIZATIONS:{ajaxErrorString:"An Error occured while fetching options",clearSelectionLabelString:"Clear Selection",clearSearchLabelString:"Clear Search Field",noResultsString:"No Results Available",placeholder:"Select an Option",searchPlaceholder:"Search",tagRemoveLabelString:"Remove Tag"},getInitialState:function(){return{ajaxError:!1,controlId:s.uniqueId("rss_"),data:this._configureDataSource(this.props.dataSource),rawDataSource:this.props.dataSource,isOpen:!1,focusedId:void 0,labelKey:this.props.optionLabelKey||"name",lastOptionId:s.isArray(this.props.dataSource)&&this.props.dataSource.length>0?this.props.dataSource.length-1:void 0,searchString:void 0,value:this._buildInitialValue(),valueKey:this.props.optionValueKey||"id"}},keymap:{down:40,end:35,enter:13,esc:27,home:36,space:32,tab:9,up:38},lastUserSelectedOption:void 0,componentWillReceiveProps:function(e){var t={};s.isEqual(e.initialValue,this.props.initialValue)||(t.value=this._buildInitialValue(e)),s.isUndefined(e.optionLabelKey)||e.optionLabelKey===this.props.optionLabelKey||(t.labelKey=e.optionLabelKey),s.isUndefined(e.optionValueKey)||e.optionValueKey===this.props.optionValueKey||(t.valueKey=e.optionValueKey),s.isEqual(this.props.dataSource,e.dataSource)||(this.lastUserSelectedOption=void 0,t=s.extend(t,{data:this._configureDataSource(e.dataSource),rawDataSource:e.dataSource,focusedId:void 0,lastOptionId:s.isArray(e.dataSource)&&e.dataSource.length>0?e.dataSource.length-1:void 0})),s.isEmpty(t)||this.setState(t)},componentDidUpdate:function(){this._focusCurrentFocusedId()},render:function(){var e,t,r,n,o=null,l=this.props.clearSelectionLabelString?this.props.clearSelectionLabelString:this.DEFAULT_LOCALIZATIONS.clearSelectionLabelString,c=this._getDropdownContent(),p=i("carat",{down:!this.state.isOpen,up:this.state.isOpen});return n=i("r-ss-wrap",this.props.customClass,{"r-ss-expanded":this.state.isOpen}),r=i("r-ss-trigger",{"r-ss-open":this.state.isOpen,"r-ss-placeholder":this.state.value.length<1}),e=this.props.placeholder?this.props.placeholder:this.DEFAULT_LOCALIZATIONS.placeholder,t=this.state.value.length?this._generateValueDisplay():e,s.isEmpty(this.state.value)||this.props.clearable===!1||(o=a.createElement("button",{"aria-label":l,ref:"selectionClear",name:"clearSelection",type:"button",className:"r-ss-selection-clear",onClick:this._clearSelection,onKeyDown:this._clearSelection},a.createElement("span",null))),a.createElement("div",{ref:"rssControl",id:this.state.controlId,className:n},a.createElement("div",{ref:"triggerDiv",className:r,onClick:this.toggleDropdown,onKeyDown:this._handleKeyDown,role:"combobox","aria-activedescendant":this._ariaGetActiveDescendentId(),"aria-haspopup":!0,"aria-controls":this._ariaGetListId(),"aria-label":e,"aria-multiselectable":this._isMultiSelect(),tabIndex:"1"},t,o,a.createElement("span",{ref:"carat",className:p}," ")),c)},toggleDropdown:function(){this.setState({isOpen:!this.state.isOpen},function(){this.state.isOpen&&this._setFocusOnOpen()})},_ariaGetActiveDescendentId:function(){var e=null,t=this._getFocusedOptionKey();return this.refs[t]&&(e=this.refs[t].props.id),e},_ariaGetListId:function(){return this.state.controlId+"_list"},_arrestEvent:function(e){e.stopPropagation(),e.preventDefault()},_buildInitialValue:function(e){e=e||this.props;var t=[];return s.isUndefined(e.initialValue)||(t=s.isArray(e.initialValue)?e.initialValue:[e.initialValue],this._isMultiSelect()||(t=[s.first(t)])),t},_clearSearchString:function(){this.setState({searchString:void 0},this._setFocusIdToSearch)},_clearSelection:function(e){(e.which===this.keymap.enter||e.which===this.keymap.space||"click"===e.type)&&(e.stopPropagation(),this.setState({value:[]},this._focusTrigger))},_closeOnKeypress:function(){this.state.isOpen&&this.setState({isOpen:!1,focusedId:void 0},this._focusTrigger)},_configureDataSource:function(e){if(s.isArray(e))return e;if(s.isObject(e)){if(s.isArray(e.collection))return e.collection;if(s.isFunction(e.get)){var t=e.get("collection");if(s.isArray(t))return t}}return[]},_defaultSearchFilter:function(e){var t=this.state.searchString.toLowerCase();return s.isString(e[this.state.labelKey])?e[this.state.labelKey].toLowerCase().indexOf(t)>-1:!1},_fetchDataViaAjax:function(){var e=this;this.props.ajaxDataFetch(this.state.rawDataSource).then(function(t){e.setState({ajaxError:!1,data:e._configureDataSource(t),rawDataSource:t})},function(){e.setState({ajaxError:!0,rawDataSource:[]})})},_fetchNextPage:function(){var e=this;this.props.pageDataFetch(this.state.rawDataSource).then(function(t){e.setState({ajaxError:!1,data:e._configureDataSource(t),rawDataSource:t,isFetchingPage:!1})},function(){e.setState({ajaxError:!0})})},_filterDataBySearchString:function(e){var t=this,i=this._defaultSearchFilter;return s.isFunction(this.props.customFilterFunction)&&(i=function(e,s,i){return t.props.customFilterFunction.apply(t,[e,s,i,t.state.searchString.toLowerCase()])}),s.filter(e,i)},_findArrayOfOptionDataObjectsByValue:function(e){var t=s.isArray(e)?s.pluck(e,this.state.valueKey):[e];return s.reject(this.state.data,function(e){return!s.contains(t,e[this.state.valueKey])},this)},_focusCurrentFocusedId:function(){return this.state.focusedId<0?void this._focusSearch():void this._focusDOMOption()},_focusDOMOption:function(){var e=this._getFocusedOptionKey();this.refs[e]&&s.isFunction(this.refs[e].getDOMNode().focus)&&this.refs[e].getDOMNode().focus()},_focusSearch:function(){this.refs.searchInput&&this.refs.searchInput.getDOMNode().focus()},_focusRemovalButtons:function(e){var t,i,a=this.refs.triggerDiv.getDOMNode(),r=a.getElementsByTagName("button");if(r.length)for(var n=0;n<r.length;n++)r[n]===document.activeElement&&(t=n,i=e.shiftKey?n-1:n+1);r[i]?(this._arrestEvent(e),r[i].focus()):i&&0>i?this._focusTrigger():r[0]&&!s.isNumber(t)&&(this._arrestEvent(e),r[0].focus())},_focusTrigger:function(){this.refs.triggerDiv&&this.refs.triggerDiv.getDOMNode().focus()},_generateValueDisplay:function(){return this.props.tags?this._getTagsDisplayMarkup():this._getNormalDisplayMarkup()},_getAjaxErrorMarkup:function(){var e=this.props.ajaxErrorString?this.props.ajaxErrorString:this.DEFAULT_LOCALIZATIONS.ajaxErrorString;return a.createElement("li",{className:"r-ss-dropdown-option error"},a.createElement("i",{ref:"errorDisplay"},e))},_getDataSource:function(){var e=s.isArray(this.state.data)?this.state.data:[];return s.isString(this.state.searchString)&&(e=this._filterDataBySearchString(e)),this.props.groupBy&&(e=s.groupBy(e,this.props.groupBy)),e},_getDropdownContent:function(){if(!this.state.isOpen)return null;var e,t,s=this._getSearchContent();return e=this.props.pageDataFetch?this._onMouseMove:null,t=this.state.isFetchingPage?this._getPagingLi():null,a.createElement("div",{ref:"dropdownContent",className:"r-ss-dropdown",onKeyDown:this._handleKeyDown},s,a.createElement("div",{ref:"scrollWrap",className:"r-ss-options-wrap",onMouseMove:e},a.createElement("ul",{className:"r-ss-dropdown-options",ref:"dropdownOptionsList",tabIndex:"-1",id:this._ariaGetListId(),role:"listbox","aria-expanded":this.state.isOpen},this._getOptionsMarkup()),t))},_getFocusedOptionKey:function(){return"option_"+this.state.focusedId},_getGroupHeadingMarkup:function(e){if(!e)return null;var t=i("r-ss-option-group-heading",this.props.customGroupHeadingClass),s="heading_"+e,r=this.props.customGroupHeadingTemplateFunction?this.props.customGroupHeadingTemplateFunction(e):e;return a.createElement("li",{tabIndex:"-1",className:t,key:s,role:"separator","aria-label":e,"aria-hidden":!0},r)},_getNoResultsMarkup:function(){var e=this.props.noResultsString?this.props.noResultsString:this.DEFAULT_LOCALIZATIONS.noResultsString;return a.createElement("li",{className:"r-ss-dropdown-option",tabIndex:"-1"},a.createElement("i",{ref:"noResults"},e))},_getNormalDisplayMarkup:function(){return s.map(this.state.value,function(e){var t="r_ss_selected_"+e[this.state.labelKey];return this.props.customOptionTemplateFunction?this.props.customOptionTemplateFunction(e):a.createElement("span",{key:t,className:"r-ss-selected-label"},e[this.state.labelKey])},this)},_getLoadingMarkup:function(){var e=this.props.customLoaderClass?"r-ss-loader "+this.props.customLoaderClass:"r-ss-loader";return a.createElement("span",{ref:"loader",className:e})},_getOptionIndexFromTarget:function(e){return parseInt(e.getAttribute("data-option-index"),10)},_getOptionsMarkup:function(){if(this._needsAjaxFetch())return this._fetchDataViaAjax(),this._getPagingLi();if(this.state.ajaxError)return this._getAjaxErrorMarkup();var e=this._getDataSource(),t=[],i=0;return s.isArray(e)?t=this._getTemplatedOptions(e):s.forIn(e,function(e,s){t.push(this._getGroupHeadingMarkup(s)),t=t.concat(this._getTemplatedOptions(e,i)),i+=e.length},this),t},_getPagingLi:function(){return a.createElement("li",{key:"page_loading",className:"r-ss-page-fetch-indicator",tabIndex:"-1"},this._getLoadingMarkup())},_getSearchContent:function(){if(!this.props.searchable)return null;var e=null,t=this.props.clearSearchLabelString?this.props.clearSearchLabelString:this.DEFAULT_LOCALIZATIONS.clearSearchLabelString,i=this.props.customSearchIconClass?this.props.customSearchIconClass:"r-ss-magnifier",r=this.props.searchPlaceholder?this.props.searchPlaceholder:this.DEFAULT_LOCALIZATIONS.searchPlaceholder,n=this.state.controlId+"_search",o=n+"_label";return s.isString(this.state.searchString)&&(e=a.createElement("button",{"aria-label":t,ref:"searchClear",name:"clearSearch",type:"button",className:"r-ss-search-clear",onClick:this._clearSearchString,onKeyDown:this._clearSearchString},a.createElement("span",null))),a.createElement("div",{className:"r-ss-search-wrap"},a.createElement("div",{className:"r-ss-search-inner"},a.createElement("label",{ref:"searchInputLabel",id:o,className:"r-ss-search-aria-label",htmlFor:n},r),a.createElement("input",{ref:"searchInput",placeholder:r,onClick:this._setFocusIdToSearch,onChange:this._handleSearch,value:this.state.searchString,name:n,id:n,"aria-labelledby":o,"aria-autocomplete":"list"}),e,a.createElement("i",{className:i},"search")))},_getTagsDisplayMarkup:function(){return s.map(this.state.value,function(e){return this._getTagMarkup(e)},this)},_getTagMarkup:function(e){var t=e[this.state.labelKey],s=e[this.state.valueKey],i="tag_"+s,r="RemoveTag_"+s,n=this._getTagRemoveIndex(s),o=this.props.tagRemoveLabelString?this.props.tagRemoveLabelString:this.DEFAULT_LOCALIZATIONS.tagRemoveLabelString,l=this.props.customTagClass?"r-ss-tag "+this.props.customTagClass:"r-ss-tag";return o=o+" "+t,a.createElement("span",{className:l,key:i},a.createElement("span",{className:"r-ss-tag-label"},t),a.createElement("button",{"aria-label":o,ref:n,name:r,type:"button",className:"r-ss-tag-remove",onClick:this._removeTagClick.bind(null,e),onKeyDown:this._removeTagKeyPress.bind(null,e)},a.createElement("span",null)))},_getTagRemoveIndex:function(e){return"tag_remove_"+e},_getTemplatedOptions:function(e,t){t=t||0;var s=this._mapDataToOptionsMarkup(e,t);return 0===s.length&&(s=this._getNoResultsMarkup()),s},_handleKeyDown:function(e){if(!this._isUserSearchTypingEvent(e))switch((this.state.isOpen||e.which!==this.keymap.tab)&&this._arrestEvent(e),e.which){case this.keymap.down:this._onDownKey(e);break;case this.keymap.end:this._onEndKey();break;case this.keymap.enter:this._onEnterKey(e);break;case this.keymap.esc:this._onEscKey();break;case this.keymap.home:this._onHomeKey();break;case this.keymap.space:this._onEnterKey(e);break;case this.keymap.tab:this.state.isOpen?this._onEnterKey(e):this._focusRemovalButtons(e);break;case this.keymap.up:this._onUpKey(e)}},_handleSearch:function(e){this._arrestEvent(e);var t=e.target.value;this._handleSearchDebounced.call(this,t)},_handleSearchDebounced:s.debounce(function(e){this.setState({searchString:e})},300),_isCurrentlySelected:function(e){return s.isArray(this.state.value)?!!s.findWhere(this.state.value,e):s.isEqual(this.state.value,e)},_isMultiSelect:function(){return this.props.multiple||this.props.tags},_isUserSearchTypingEvent:function(e){return!this.refs.searchInput||e.which===this.keymap.down||e.which===this.keymap.up&&e.altKey||e.which===this.keymap.esc?!1:e.target===this.refs.searchInput.getDOMNode()},_mapDataToOptionsMarkup:function(e,t){return s.map(e,function(e,r){r=t+r;var n=this._isCurrentlySelected(e),o="drop_li_"+e[this.state.valueKey],l="option_"+r,c=this.state.controlId+"_aria_"+l,p=s.isFunction(this.props.customOptionTemplateFunction)?this.props.customOptionTemplateFunction(e):e[this.state.labelKey],u=i("r-ss-dropdown-option",{"r-ss-selected":n});return a.createElement("li",{ref:l,id:c,tabIndex:"0","data-option-index":r,className:u,"aria-selected":n,key:o,"data-option-value":e[this.state.valueKey],onClick:this._selectItemOnOptionClick.bind(null,e),role:"option"},p)},this)},_moveFocusDown:function(){if(!this._needsAjaxFetch()){var e;e=s.isUndefined(this.state.focusedId)?this.props.searchable?this.SEARCH_FOCUS_ID:0:this.state.lastOptionId===this.state.focusedId?this.state.lastOptionId:this.state.focusedId+1,this._updateFocusedId(e)}},_moveFocusUp:function(){var e;s.isUndefined(this.state.focusedId)||this.state.focusedId===this.SEARCH_FOCUS_ID||(0===this.state.focusedId?this.props.searchable&&(e=this.SEARCH_FOCUS_ID):e=this.state.focusedId-1),this._updateFocusedId(e)},_needsAjaxFetch:function(){return s.isUndefined(this.state.rawDataSource)&&s.isFunction(this.props.ajaxDataFetch)},_onDownKey:function(e){return this.state.isOpen?(this._moveFocusDown(),void(this._isMultiSelect()&&e.shiftKey&&this._selectFocusedOption(e.target,!0))):void this.toggleDropdown()},_onEndKey:function(){this.state.lastOptionId&&this._updateFocusedId(this.state.lastOptionId)},_onEnterKey:function(e){if(!this.state.isOpen)return void this.toggleDropdown();if(this._isMultiSelect()&&e.shiftKey)return void this._selectAllOptionsToLastUserSelectedOption(e.target);var t=this._isMultiSelect()&&(e.ctrlKey||e.metaKey);this._selectFocusedOption(e.target,t)},_onEscKey:function(){this._closeOnKeypress()},_onHomeKey:function(){this._updateFocusedId(0)},_onMouseMove:function(){if(!this.refs.loader&&!this.state.searchString&&this._pageFetchingComplete()){var e=this.refs.scrollWrap.getDOMNode();e.scrollTop+e.offsetHeight>=e.scrollHeight&&this.setState({isFetchingPage:!0},this._fetchNextPage)}},_onUpKey:function(e){return e.altKey?void this._closeOnKeypress():void(this.state.isOpen&&(this._moveFocusUp(),this._isMultiSelect()&&e.shiftKey&&this._selectFocusedOption(e.target,!0)))},_pageFetchingComplete:function(){return s.isFunction(this.props.hasMorePages)?this.props.hasMorePages(this.state.rawDataSource):!1},_removeAllOptionsInOptionIdRange:function(e,t){for(var i=[],a=t>=e?e:t,r=t>=e?t:e,n=a;r>=n;n++){var o="option_"+n,l=this.refs[o];this.SELECTED_OPTION_REGEX.test(l.props.className)&&this.lastUserSelectedOption.getAttribute("data-option-value")!==l.getDOMNode().getAttribute("data-option-value")&&i.push(l.props["data-option-value"])}var c=s.reject(this.state.value,function(e){return s.includes(i,e[this.state.valueKey])},this);this.props.onChange(c),this.setState({value:c})},_removeSelectedOptionByValue:function(e,t){this.lastUserSelectedOption&&this.lastUserSelectedOption.getAttribute("data-option-value")===e[this.state.valueKey]&&(this.lastUserSelectedOption=void 0);var i=s.reject(this.state.value,function(t){return t[this.state.valueKey]===e[this.state.valueKey]},this);this.props.onChange(i),t=s.isFunction(t)?t:s.noop,this.setState({value:i},t)},_removeTagKeyPress:function(e,t){var s=t.which===this.keymap.enter,i=t.which===this.keymap.space;(s||i)&&(this._arrestEvent(t),this._removeSelectedOptionByValue(e,this._setFocusToTagRemovalIfPresent))},_removeTagClick:function(e,t){this._arrestEvent(t),this._removeSelectedOptionByValue(e)},_selectAllOptionsInOptionIdRange:function(e,t){for(var i=[],a=t>=e?e:t,r=t>=e?t:e,n=a;r>=n;n++){var o="option_"+n,l=this.refs[o];this.SELECTED_OPTION_REGEX.test(l.props.className)||i.push(l.props["data-option-value"])}var c=s.reduce(this.state.data,function(e,t){return s.includes(i,t[this.state.valueKey])&&e.push(t),e},[],this);this._selectItemByValues(c,!0)},_selectAllOptionsToLastUserSelectedOption:function(e){if(!this.lastUserSelectedOption)return this.lastUserSelectedOption=e,void this._selectAllOptionsInOptionIdRange(0,this._getOptionIndexFromTarget(e));var t=this._getOptionIndexFromTarget(this.lastUserSelectedOption),s=this._getOptionIndexFromTarget(e);this.lastUserSelectedOption=e,this.SELECTED_OPTION_REGEX.test(e.getAttribute("class"))?this._removeAllOptionsInOptionIdRange(t,s):this._selectAllOptionsInOptionIdRange(t,s)},_selectFocusedOption:function(e,t){var i=this._getFocusedOptionKey();if(this.refs[i]){var a=this.refs[i].props["data-option-value"];if(this.lastUserSelectedOption=e,this.SELECTED_OPTION_REGEX.test(this.refs[i].props.className)){var r=s.first(this._findArrayOfOptionDataObjectsByValue(a));this._removeSelectedOptionByValue(r)}else t=t||!1,this._selectItemByValues(a,t)}},_selectItemByValues:function(e,t){var i=this._findArrayOfOptionDataObjectsByValue(e);(this._isMultiSelect()||t&&this.state.value)&&(i=this.state.value.concat(i));var a=this._isMultiSelect()?i:s.first(i);this.props.onChange(a),t?this.setState({value:i}):this.setState({value:i},this._closeOnKeypress)},_selectItemOnOptionClick:function(e,t){if(this._isMultiSelect()&&t.shiftKey)return void this._selectAllOptionsToLastUserSelectedOption(t.currentTarget);var s=this._isMultiSelect()&&(t.ctrlKey||t.metaKey),i=this.SELECTED_OPTION_REGEX.test(t.currentTarget.getAttribute("class"));this.lastUserSelectedOption=t.currentTarget,i?this._removeSelectedOptionByValue(e):this._selectItemByValues(e[this.state.valueKey],s)},_setFocusIdToSearch:function(){this._updateFocusedId(this.SEARCH_FOCUS_ID)},_setFocusOnOpen:function(){this.lastUserSelectedOption?this._updateFocusedId(parseInt(this.lastUserSelectedOption.getAttribute("data-option-index"),10)):this._moveFocusDown()},_setFocusToTagRemovalIfPresent:function(){if(!this.props.tags||0===this.state.value.length)return!1;var e=s.first(this.state.value)[this.state.valueKey],t=this.refs[this._getTagRemoveIndex(e)];return t&&s.isFunction(t.getDOMNode().focus)?(t.getDOMNode().focus(),!0):!1},_updateFocusedId:function(e){this.setState({focusedId:e})}});t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});